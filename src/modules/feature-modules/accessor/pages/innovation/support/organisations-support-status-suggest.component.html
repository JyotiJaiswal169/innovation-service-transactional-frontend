<div class="nhsuk-grid-row">
  <div class="nhsuk-grid-column-full">
    <h1 class="nhsuk-heading-xl nhsuk-u-margin-bottom-5">Suggest organisations for support</h1>
  </div>
</div>

<ng-container *ngIf="summaryAlert.type">
  <div class="nhsuk-error-summary" [ngClass]="{'border-color-warning': summaryAlert.type === 'warning'}" aria-labelledby="alert-summary-title" role="alert" tabindex="-1">
    <h2 class="nhsuk-error-summary__title" id="alert-summary-title">{{ summaryAlert.title }}</h2>
    <div class="nhsuk-error-summary__body" [innerHTML]="summaryAlert.message"></div>
  </div>
</ng-container>

<div class="nhsuk-grid-row">
  <div class="nhsuk-grid-column-full">
    <p>Select the organisations you think would be right to offer support. These organisations will be notified.</p>
    <!-- <p class="nhsuk-u-margin-0"><a href="/">Support offer guide (opens in a new window) </a></p> -->
  </div>
</div>


<form [formGroup]="form">

  <ng-container *ngIf="stepId === 1">
    <div class="nhsuk-grid-row">
      <div class="nhsuk-grid-column-full">
        <theme-form-grouped-checkbox-array arrayName="organisationUnits" [groupedItems]="groupedItems"></theme-form-grouped-checkbox-array>
        <button class="nhsuk-button nhsuk-u-margin-top-3 nhsuk-u-margin-right-3" (click)="onSubmitStep()">Continue</button>
        <div>
          <a routerLink="/accessor/innovations/{{ innovationId }}/support" class="nhsuk-back-link__link nhsuk-u-padding-left-0 nhsuk-u-margin-bottom-5">Cancel</a>
        </div>
      </div>
    </div>
  </ng-container>

  <ng-container *ngIf="stepId === 2">
    <div class="nhsuk-grid-row">
      <div class="nhsuk-grid-column-two-thirds">

        <h2>Selected organisations (this is uggly, I know)</h2>

        <div *ngFor="let organisation of chosenUnits">
          <p>{{ organisation.organisation }}</p>

          <div *ngFor="let unit of organisation.units">
            <p>--- {{ unit }}</p>
          </div>

        </div>

        <theme-form-textarea controlName="comment" label="Describe briefly why you selected these organisations"></theme-form-textarea>
        <theme-form-checkbox controlName="confirm" label="Only show innovations assigned to me" size="small"></theme-form-checkbox>
        <p *ngIf="formSubmitted" class="font-color-error">You need to confirm to proceed</p>
        <button class="nhsuk-button nhsuk-u-margin-top-3 nhsuk-u-margin-right-3" (click)="onSubmit()">Confirm and notify organisations</button>
        <div>
          <a routerLink="/accessor/innovations/{{ innovationId }}/support" class="nhsuk-back-link__link nhsuk-u-padding-left-0 nhsuk-u-margin-bottom-5">Cancel</a>
        </div>
      </div>
    </div>
  </ng-container>

</form>
