<ng-container *ngIf="summaryAlert.type">
  <div class="nhsuk-error-summary" [ngClass]="{'border-color-success': summaryAlert.type === 'success', 'border-color-warning': summaryAlert.type === 'warning'}" aria-labelledby="alert-summary-title" role="alert"
    tabindex="-1">
    <h2 class="nhsuk-error-summary__title" id="alert-summary-title">{{ summaryAlert.title }}</h2>
    <div class="nhsuk-error-summary__body" [innerHTML]="summaryAlert.message"></div>
  </div>
</ng-container>

<h1 class="nhsuk-u-margin-bottom-3"> Innovation record </h1>

<div class="nhsuk-grid-row">
  <div class="nhsuk-grid-column-full">

    <ul class="progressbar progressbar-justified nhsuk-u-padding-bottom-2">
      <li *ngFor="let item of sections.progressBar" class="progressbar-item" [ngClass]="{'active': item}"></li>
    </ul>

    <p class="d-flex nhsuk-u-margin-0">
      <theme-svg-icon type="success"></theme-svg-icon>
      <span class="nhsuk-u-margin-right-2"></span> {{ sections.submitted }} sections submitted
    </p>
    <p class="d-flex nhsuk-u-margin-0">
      <theme-svg-icon type="edit"></theme-svg-icon>
      <span class="nhsuk-u-margin-right-2"></span> {{ sections.draft }} section in draft
    </p>
    <p class="d-flex">
      <theme-svg-icon type="error"></theme-svg-icon>
      <span class="nhsuk-u-margin-right-2"></span> {{ sections.notStarted }} sections not started
    </p>

    <ng-container *ngIf="isInnovationInCreatedStatus()">
      <button class="nhsuk-button nhsuk-u-margin-bottom-2" [disabled]="!allSectionsSubmitted()" (click)="onSubmitInnovation()"> Submit record for needs assessment </button>
      <p class="nhsuk-body-s">Submit all sections before you can submit your record for needs assessment</p>
    </ng-container>

    <h2>All sections</h2>
    <a [href]="documentUrl">
      <h3 class="nhsuk-u-margin-bottom-6">Download all questions (DOCX, 820KB)</h3>
    </a>

    <ol class="app-task-list">
      <li *ngFor="let sectionGroup of innovationSections; let i = index">

        <h2 class="app-task-list__section">
          <span class="app-task-list__section-number">{{ i + 1 }}. </span> {{ sectionGroup.title }}
          <span *ngIf="i === 0" class="nhsuk-heading-xs nhsuk-u-margin-bottom-0 float-r">Open actions</span>
        </h2>

        <ul class="app-task-list__items">
          <li *ngFor="let section of sectionGroup.sections; let j = index" class="app-task-list__item">

            <ng-container *ngIf="section.status !== 'UNKNOWN'">
              <span class="app-task-list__task-icon">
                <ng-container *ngTemplateOutlet="icon; context: { status: section.status }"></ng-container>
              </span>
            </ng-container>

            <span class="app-task-list__task-name"> {{ (i + 1) + '.' + (j + 1) }} <a routerLink="{{ baseUrl }}/{{section.id}}" class="nhsuk-link">{{ section.title }}</a> </span>

            <strong *ngIf="section.actionStatus" class="nhsuk-tag app-task-list__tag" [ngClass]="innovationSectionActionStatus[section.actionStatus].cssClass">
              {{ innovationSectionActionStatus[section.actionStatus].label }}
            </strong>

          </li>
        </ul>

      </li>
    </ol>

  </div>
</div>


<ng-template #icon let-status="status">
  <theme-svg-icon *ngIf="status === 'NOT_STARTED'" type="error"></theme-svg-icon>
  <theme-svg-icon *ngIf="status === 'DRAFT'" type="edit"></theme-svg-icon>
  <theme-svg-icon *ngIf="status === 'SUBMITTED'" type="success"></theme-svg-icon>
</ng-template>